---
layout: post
title: HHKB @ OS X 使用报告
---

### 缘起

键盘对于开发者的重要性无需多言。如果你不是一个开发者或其他键盘重度用户，或不是 OS X 用户，这文章应该不是为你准备的。

对于 HHKB 本身，[这里有一篇非常详尽的评测](https://www.keychatter.com/2015/02/24/review-happy-hacking-keyboard-pro-2/)。我提供一份摘要：

> - 历史
> - 目标用户
> - 开箱
> - 外观
> - 内部
> - 键结构分析和输入演示（有 Youtube 视频）
>   电容结构，不是 Cherry MX 这类「轴」。
> - 键位布局
>   仅有主键区五排键。没有方向键和上面一组功能键、F 功能键。`Esc`、左 `Ctrl`、`~`、`Del/Backspace`、`\` 的位置比较特别。
> - 美学
> - 常见的 mod（对，键盘也有 mod）

那篇评测写得实在太好，我只补充两点：

1. 45g 的触发重量在一开始可能显得太小。我自己有好几次，大脑里并没有按下去的指令，但系统检测到了我的输入。过一段时间习惯了就好。
2. 原文评测的是 Pro 2，而我手上这一块是 Pro 2 Type-S，对键结构做了降噪处理，价格更高，手感略有差别，其余都一样。即使是这个版本，我依然觉得声音可能偏大。至少绝对不适合寝室里有个比你睡得早、又讨厌任何噪音的室友的情况。当然，如果无需考虑是否干扰他人，这个声音听起来还是挺让我愉悦的。

关于购买渠道，几个电商平台应该都有，如果有朋友去日本也可以欠个人情让他带。

这篇文章主要是整理我自己在 OS X 上的工作流如何和 HHKB 整合。内容包括：

- 浏览器
- 编辑器
- 终端
- OS X 的其他界面
- 番外：人体工学折腾录

### 一些基本知识

- OS X 上大部分接受文本输入的区域是可以使用部分 Emacs 快捷键进行操作的，甚至包括终端。

> - `Ctrl+p` 终端中上一个命令，或者文本中移动到上一行
> - `Ctrl+n` 终端中下一个命令，或者文本中移动到下一行
> - `Ctrl+r` 往后搜索历史命令
> - `Ctrl+s` 往前搜索历史命令
> - `Ctrl+f` 光标前移
> - `Ctrl+b` 光标后退
> - `Ctrl+a` 到行首
> - `Ctrl+e` 到行尾
> - `Ctrl+d` 删除一个字符，相当于通常的 Delete 键
> - `Ctrl+h` 退格删除一个字符，相当于通常的 Backspace 键
> - `Ctrl+u` 删除到行首
> - `Ctrl+k` 删除到行尾
> - `Ctrl+l` 类似 clear 命令效果
> - `Ctrl+y` 粘贴
> - `Ctrl+o` 在光标后插入新行

- rMBP 13″ 上，可以把键盘最高的支撑脚放下来，左边卡住原键盘的 `~` 键，右边卡住原键盘的 `+` 键。这样刚好可以让 HHKB 代替原键盘，还可以使用内置的 Trackpad。尺寸接近完美。
唯一的问题是连接线的位置非常尴尬，所以这基本只适用于去咖啡馆工作的时候。办公室或家里，请参考本文最后。
至于 15″，我暂时没有机会测试。
- HHKB 使用一组后侧的跳线来配置某些键的行为，调整需要用到针或类似物。具体定义可以看键盘底面。
考虑到 OS X 的常见使用习惯，我采用了（忘记在哪看到的）这样的一组配置：011001。前两位合起来是设置为 Macintosh 模式，第三位是将 Delete 设为 Backspace，最后一位是允许 HHKB 唤醒电脑。

### 浏览器

我出于习惯使用 Firefox。（Chrome 发布的时候我已经有四五年网龄了吧……习惯很不容易改变。）Chrome 也有，仅作前端兼容测试用，用得很少。

Firefox 上有一个很强大的插件 Vimperator。它的设计思想是，将 Vim 的交互理念带入 Firefox。Chrome 那边应该有相应的移植，但我并没有去查。

这里先离一下题：根据[《内核恐慌》第四期《编辑器巡礼》](http://ipn.li/kernelpanic/4/)的说法，Vim 显式强调了「用户操作一定是处在某个『状态』下」这个概念：部分情况下我们是「输入」新的文字，部分情况下我们是在文档中导航或者别的「操作」，还有部分情况是「调用外部命令」比如保存、编译。这是粗浅的概括，具体得实际用过一段时间的 Vim 才能理解。减少手指移动之类的其实是附加产品。

回到 Vimperator 来。完整的文档在普通模式下输入 `:helpall` 可以看到，和 Vim 的一样，长到你不想一次看完。这里有一些基本的用法（部分感谢[善用佳软](http://xbeta.info/vimperator.htm)）：

> - `fF` 进入 Hint 模式，可以用键盘（默认是数字键，可以修改）打开网页上的链接。
    小写是在当前页面打开，大写是在新标签页打开。
> - `;` 进入高级 Hint 模式，可以对链接进行各种操作
> - `hjkl` 导航键
> - `H,L` 前进后退键
> - `Ctrl+n` 下一个标签页
> - `Ctrl+p` 上一个标签页
> - `Ctrl+6` 前后两个标签页切换
> - `o url` 在当前标签页打开 URL 或给搜索引擎的关键词
> - `t url` 在新标签页打开 URL 或给搜索引擎的关键词
> - `/` 在当前页面搜索
> - `nN` 下一个（或上一个）搜索字词
> - `d` 关闭当前标签页
> - `u` 重新打开之前关闭的标签页
> - `[num]gg` 到页面 `num`% 的位置，如省略则默认 0%，即顶部
> - `G` 到页面底部
> - `zi` 页面放大
> - `zo` 页面缩小
> - `zz` 恢复页面大小
> TODO：如何选择搜索引擎的候选项

和 Vim 一样，可以为 Vimperator 写配置文件，保存成 `~/.vimperatorrc`。

前端开发者可能会想把一系列开发工具定义成命令，比如：

    :com -nargs=0 firebug emenu 查看.Firebug

可以添加一条自定义命令 `:firebug` 来执行查看菜单里的 Firebug。这里要使用本地化过的菜单项。Firebug 自身的快捷键可以随意改。

### 编辑器

如果非要我在编辑器圣战里面选一边，我是 Vim 这边的。

我使用的主力编辑器是 Sublime Text 2。我知道有 3，但在正式版发布前我不想迁移过去。终端里自然就是 Vim 啦。
ST2 本身有一个插件 Vintage，默认是关闭的，可以实现一些基础的 Vim（或是 vi？）操作。如果你需要全功能的 Vim，直接去终端下用 Vim 即可。OS X 下需求新版本可以用 homebrew 装 Vim，或者自己安装别的移植。
这里主要的问题是，如果你的文本夹杂着中文和英文，甚至还有其他语言的话，输入法切换和 Vim 状态切换混在一起，简直就是噩梦。
我在试图将 RIME 直接嵌入 ST2 作为一个插件，这样就可以和 Vintage 合理搭配使用了。但目前这还只是一个 TODO 而已……
还有一个小问题。Normal 模式下按 `:`，其实是等效于先按 `Command+Shift+P` 叫出命令面板，然后自动输入一个冒号。如果你只是用来 `:w` 之类的就接一个 `w` 好了；但如果你是要调用自身的命令，比如 `set syntax: css` 的话，就只能从命令冒号后面的部分开始输入。幸好 ST2 几乎所有的命令都是 a: b 这样的形式。

Vim 的话，我很难想象会有人需要在 Vim 里大量输入中文。我相信应该也有人发明过「中文输入法作为一个特殊状态」这样的轮子了。
我有认真考虑是否要买个 USB 踏板……做 `Ctrl` 也好 `Esc` 也好。等真的一个人住了再说吧。

### 终端

oh-my-zsh

### OS X 的其他界面

HyperSwitch 这个小软件可以补充 OS X 的 `Command+Tab` 只能在应用间切换的缺点，你可以指定比如 `Alt+Tab` 在应用内不同窗口切换。

Finder 说实话我还没有找到 Vimperator 类似的东西。又是一个 TODO……
我当然知道终端里有一整套命令。但如果是需要在 Finder 内预览的文件，比如照片、PDF 呢？GUI 有它不可替代的作用。

Launchpad、Mission Control、Exposé，和其他桌面，有两个解决方案。一是再买块 Trackpad，反正你也不会频繁地使用这些手势（如果你真的频繁使用，加个显示器才是正经），偶尔动左手划一下问题也不是很大。缺点很明显，几百块钱，还要多操心电池问题。二是指定全局快捷键，但问题是如果你要避开大多数软件的常用快捷键，这个快捷键很可能一点都不快捷……
